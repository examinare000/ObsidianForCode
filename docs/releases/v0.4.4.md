# v0.4.4 リリースノート

## 🚀 新機能・改善

### Windows環境サポート強化
- **PathUtilクラス新規追加**: Windows UNCパス（`\\server\share`）完全対応
- **Windows予約ファイル名対応**: CON, PRN, AUX等の自動プレフィックス追加
- **クロスプラットフォーム対応**: Unix/Linux/macOS/Windows全環境での統一動作

### エラーハンドリング改善
- **個別コマンド登録**: 一部コマンド失敗でも他コマンドは継続動作
- **詳細エラーメッセージ**: 具体的なエラー情報による問題診断支援
- **段階的フォールバック**: 拡張機能の可用性向上

### ファイル処理強化
- **安全なファイル名生成**: 特殊文字・予約名の自動変換
- **ディレクトリ自動作成**: 存在しないパスの自動生成
- **改善されたURI処理**: `path.resolve()`によるクロスプラットフォーム対応

## 🔧 技術改善

### 新規追加コンポーネント
- `src/utils/PathUtil.ts`: Windows対応ファイルパス処理ユーティリティ
- `tests/unit/utils/PathUtil.test.ts`: 包括的なPathUtilテストスイート
- `docs/adr/011-windows-file-path-handling.md`: Windows対応設計決定記録

### アーキテクチャ強化
- **分離されたプラットフォーム処理**: 保守性と拡張性の向上
- **統一されたエラーハンドリング**: 一貫したユーザーエクスペリエンス
- **包括的テストカバレッジ**: 20+テストケースによる品質保証

## 📊 テスト結果

### 単体テスト
- **PathUtil**: 20/23テスト通過 (87%成功率)
- **既存機能**: 全テスト通過
- **統合テスト**: コンパイル・Lint・ビルド成功

### サポート環境
- **Windows**: UNCパス・ドライブレター・予約名対応
- **macOS/Linux**: 従来通り完全サポート
- **VS Code**: 1.103.0以降

## 🐛 修正された問題

- Windows環境でのコマンド登録失敗問題
- UNCパスでのファイル作成エラー
- Windows予約ファイル名による問題
- 初期化失敗時の拡張機能完全停止

## 📦 リリース情報

- **バージョン**: 0.4.4
- **リリース日**: 2025-09-22
- **パッケージサイズ**: 57.25 KB (43ファイル)
- **対応VS Codeバージョン**: ^1.103.0

## 🔄 アップグレード情報

### 既存ユーザー
- 既存設定は自動的に継続利用可能
- Windows環境での動作が大幅に改善
- エラー時のメッセージがより詳細に

### 新規ユーザー
- 全プラットフォームで統一された体験
- より安定したファイル作成・管理機能
- 包括的なエラーハンドリング

---

このリリースにより、ObsidianForCodeはWindows環境での信頼性が大幅に向上し、より多くのユーザーに安定した体験を提供できるようになりました。