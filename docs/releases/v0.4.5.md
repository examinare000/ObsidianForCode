# v0.4.5

## 🚀 機能改善

- **Windowsサポート強化**: Node.js標準API(`path.isAbsolute`)を利用するようパス解決ロジックを刷新し、Windows環境での安定性を大幅に向上させました。

## 🐛 バグ修正

- **コマンド登録エラーの解決**: UNCパス(`\\server\share`)やシンボリックリンクなど、特殊なパス形式のWindows環境で拡張機能のコマンドが登録されなかった問題を修正しました。これにより、`Extension Install from location` でのインストール時も正常に動作します。

## 📋 技術的詳細

### 修正された問題

Windows環境において、特に開発環境で「Install from location」機能を使用してExtensionをインストールした際に、以下の問題が発生していました：

- WikiLinkコマンド（`Ctrl+Enter`）が反応しない
- コマンドパレットに拡張機能のコマンドが表示されない
- 拡張機能は有効化されているが、実際の機能が使用できない

### 根本原因

`PathUtil.isAbsolutePath()` の自作実装が、Windows環境の多様なパス形式に完全対応していなかったため、絶対パスが相対パスと誤認され、不正なURIが生成されていました。

特に以下のパス形式で問題が発生：
- UNCパス: `\\server\share`
- 拡張パス: `\\?\C:\path\to\extension`
- シンボリックリンク経由のパス

### 修正内容

- **`PathUtil.isAbsolutePath()`**: 自作実装をNode.js標準の`path.isAbsolute()`に置き換え
- **パス解決の堅牢化**: Windows環境の特殊パス形式に標準対応
- **テスト強化**: Windows特有のパス形式に対するテストケースを追加

### 影響範囲

この修正により、Windows環境でのExtension開発・使用において、以下の改善が期待されます：

- ✅ 「Install from location」での確実なコマンド登録
- ✅ 多様なWindowsパス形式への対応
- ✅ 将来のNode.jsバージョンアップでの自動的な恩恵享受

## 🔗 関連ドキュメント

- [ADR-013: Node.js標準 path.isAbsolute の採用](../adr/013-nodejs-path-isabsolute-adoption.md)
- [Windows環境トラブルシューティング](../tech/troubleshooting-windows.md)